# StoryChat API - Worker Configuration
name = "storychat-api"
main = "src/index.ts"
compatibility_date = "2026-02-26"

# D1 Database - Primary relational
[[d1_databases]]
binding = "DB"
database_name = "storychat-db"
database_id = "a17edd41-6a29-4d48-adb4-fe4e607e4963"

# KV Namespaces
[[kv_namespaces]]
binding = "SESSIONS"
id = "2c0ef1885e234658b13b87cea3474a36"

[[kv_namespaces]]
binding = "RATELIMIT"
id = "c3c5ac1c6c5b4f69918912a4ac43a246"

# R2 Media Storage
[[r2_buckets]]
binding = "MEDIA_BUCKET"
bucket_name = "storychat-media"

# Secrets (set via: wrangler secret put SECRET_NAME)
# GOOGLE_CLIENT_ID
# GOOGLE_CLIENT_SECRET
# JWT_SECRET
# VAPID_PUBLIC_KEY
# VAPID_PRIVATE_KEY
# VAPID_SUBJECT

[vars]
ENVIRONMENT = "production"
API_VERSION = "v1"
CORS_ORIGIN = "https://storychat.pages.dev"
JWT_EXPIRY_HOURS = "24"

[env.development]
vars = { ENVIRONMENT = "development", CORS_ORIGIN = "http://localhost:3000" }

[env.staging]
vars = { ENVIRONMENT = "staging", CORS_ORIGIN = "https://staging-storychat.pages.dev" }
